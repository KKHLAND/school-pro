<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 교육사업평가분석토론회</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --gold-100: #fef3c7;
      --gold-200: #fde68a;
      --gold-300: #fcd34d;
      --gold-400: #fbbf24;
      --gold-500: #f59e0b;
      --gold-600: #d97706;
    }
    
    * { 
      font-family: 'Noto Sans KR', sans-serif; 
      box-sizing: border-box;
    }
    
    .font-display {
      font-family: 'Playfair Display', serif;
    }
    
    body {
      background: #0a0a0f;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    /* 배경 그라데이션 오브 */
    .bg-orb {
      position: fixed;
      border-radius: 50%;
      filter: blur(120px);
      pointer-events: none;
      z-index: 0;
      opacity: 0.4;
    }
    
    .bg-orb-1 { width: 600px; height: 600px; background: radial-gradient(circle, rgba(251,191,36,0.15) 0%, transparent 70%); top: -200px; right: -100px; }
    .bg-orb-2 { width: 500px; height: 500px; background: radial-gradient(circle, rgba(139,92,246,0.1) 0%, transparent 70%); bottom: 10%; left: -150px; }
    .bg-orb-3 { width: 400px; height: 400px; background: radial-gradient(circle, rgba(59,130,246,0.08) 0%, transparent 70%); top: 40%; right: 10%; }
    
    /* 노이즈 오버레이 */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
      z-index: 1;
    }
    
    /* 글래스모피즘 카드 */
    .glass {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }
    
    .glass-strong {
      background: rgba(255, 255, 255, 0.06);
      backdrop-filter: blur(30px);
      -webkit-backdrop-filter: blur(30px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .glass-card {
      background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .glass-card:hover {
      background: linear-gradient(135deg, rgba(255,255,255,0.12) 0%, rgba(255,255,255,0.04) 100%);
      border-color: rgba(251, 191, 36, 0.3);
      transform: translateY(-4px);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(251, 191, 36, 0.1);
    }
    
    /* 골드 그라데이션 */
    .gold-gradient {
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
    }
    
    .gold-text {
      background: linear-gradient(135deg, #fef3c7 0%, #fbbf24 50%, #d97706 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .gold-glow {
      box-shadow: 0 0 40px rgba(251, 191, 36, 0.2), 0 0 80px rgba(251, 191, 36, 0.1);
    }
    
    /* 애니메이션 */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideRight {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes pulse-soft {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    .animate-fade-up { animation: fadeUp 0.6s ease-out forwards; }
    .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
    .animate-slide-right { animation: slideRight 0.4s ease-out forwards; }
    .animate-pulse-soft { animation: pulse-soft 3s infinite; }
    
    .stagger-1 { animation-delay: 0.1s; opacity: 0; }
    .stagger-2 { animation-delay: 0.2s; opacity: 0; }
    .stagger-3 { animation-delay: 0.3s; opacity: 0; }
    .stagger-4 { animation-delay: 0.4s; opacity: 0; }
    .stagger-5 { animation-delay: 0.5s; opacity: 0; }
    
    /* 버튼 스타일 */
    .btn-gold {
      background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%);
      color: #0a0a0f;
      font-weight: 600;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .btn-gold::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, #fef3c7 0%, #fbbf24 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .btn-gold:hover::before { opacity: 1; }
    .btn-gold:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(251, 191, 36, 0.3); }
    .btn-gold span { position: relative; z-index: 1; }
    
    /* 탭 스타일 */
    .tab-btn {
      position: relative;
      color: rgba(255, 255, 255, 0.5);
      transition: all 0.3s ease;
    }
    
    .tab-btn::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, #fbbf24, #d97706);
      transition: all 0.3s ease;
      transform: translateX(-50%);
    }
    
    .tab-btn:hover { color: rgba(255, 255, 255, 0.8); }
    .tab-btn.active { color: #fbbf24; }
    .tab-btn.active::after { width: 100%; }
    
    /* 카테고리 태그 */
    .category-tag {
      font-size: 0.7rem;
      padding: 0.35rem 0.75rem;
      border-radius: 100px;
      font-weight: 500;
      letter-spacing: 0.02em;
    }
    
    /* 스크롤바 */
    .custom-scrollbar::-webkit-scrollbar { width: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.03); border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(251, 191, 36, 0.3); border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(251, 191, 36, 0.5); }
    
    /* 셀렉트 박스 */
    select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23fbbf24'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 1rem;
    }
    
    /* 드롭존 */
    .drop-zone {
      border: 2px dashed rgba(251, 191, 36, 0.25);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
    }
    
    .drop-zone::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.05) 0%, transparent 100%);
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    
    .drop-zone:hover, .drop-zone.dragover {
      border-color: rgba(251, 191, 36, 0.5);
    }
    
    .drop-zone:hover::before, .drop-zone.dragover::before { opacity: 1; }
    
    /* 모달 오버레이 */
    .modal-overlay {
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
    }
    
    /* 진행률 바 */
    .progress-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 100px;
      overflow: hidden;
    }
    
    .progress-fill {
      background: linear-gradient(90deg, #fbbf24, #d97706);
      border-radius: 100px;
      transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    /* 상태 인디케이터 */
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }
    
    .status-answered { background: #22c55e; box-shadow: 0 0 10px rgba(34, 197, 94, 0.5); }
    .status-pending { background: #eab308; box-shadow: 0 0 10px rgba(234, 179, 8, 0.5); }
    .status-discussion { background: #3b82f6; box-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
    
    /* 텍스트 말줄임 */
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .line-clamp-3 {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    /* 희망 답변 방식 표시 */
    .response-type {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 500;
    }
    
    .response-type.discussion { background: rgba(59, 130, 246, 0.2); color: #93c5fd; border: 1px solid rgba(59, 130, 246, 0.3); }
    .response-type.survey { background: rgba(168, 85, 247, 0.2); color: #d8b4fe; border: 1px solid rgba(168, 85, 247, 0.3); }
    .response-type.dept { background: rgba(34, 197, 94, 0.2); color: #86efac; border: 1px solid rgba(34, 197, 94, 0.3); }
    
    /* 의견 카드 */
    .opinion-card {
      background: rgba(255, 255, 255, 0.03);
      border-left: 3px solid rgba(251, 191, 36, 0.5);
      padding: 1rem;
      border-radius: 0 8px 8px 0;
    }
  </style>
</head>
<body class="text-white">
  <!-- 배경 오브 -->
  <div class="bg-orb bg-orb-1"></div>
  <div class="bg-orb bg-orb-2"></div>
  <div class="bg-orb bg-orb-3"></div>

  <div id="app" class="relative z-10"></div>

  <script>
    // ========== 내장 데이터 (엑셀에서 추출) ==========
    const EMBEDDED_DATA = [
  {
    "연번": 1,
    "제안자": "E교사",
    "사업명": "특근 매식비",
    "담당부서": "행정실",
    "현황_문제점": "특근 매식을 학교 식당이나 정해진 식당(은혜성)에서만 사용해야 함.\n이럴 경우 식단조절이나 특별히 음식을 가려야 하는 사람에게 초근을 하면서 식사를 하지 못하게 하는 결과를 초래함.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "지난 학교에서 특근 매식비를 매번 품의 하지 않고도 초과근무를 상신한 후 행정실에서 학교 카드를 받아 원하는 곳에서 배달시켜 먹거나 직접 가서 먹고 영수증과 내역서를 제출하였습니다. 이런 방식으로 하는 것이 가능하도록 했으면 좋겠습니다.",
    "담당부서답변": "특근매식비를 포함한 모든 예산 집행은 사전 품의를 원칙으로 함. 현재 월초 사전품의-월말 초과근무 내역 확인-결제(카드결제 또는 계좌이체) 진행하고 있음\n개개인이 원하는 식사를 하기 위해서는 매 건 품의를 개별적으로 진행해야 해 전교직원의 업무처리에 애로사항이 발생할 수 있음\n아울러, 희망하는 업체 의견 제출 시 반영을 위해 적극 검토를 위해 노력하겠음\n\n직원 편의를 도모하여 제안하신 의견에는 충분이 공감하나, 원묵고등학교는 다른 일반고등학교에 비해 예산이 2배 이상이며, 초과근무 직원도 많아 제안하신 의견대로 하기에는 행정업무 가중 및 문서생산이 많아지기때문에 지금 현재로선 어려울것 같습니다. 혹시 원하는 식당이 있으시면 식당과 협의하여 특근매식비 집행이 가능한지 타진해보도록 하겠습니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 2,
    "제안자": "B교사",
    "사업명": "학교교육사업평가분석 토론회",
    "담당부서": "연구부",
    "현황_문제점": "1.작년에 전체 토론으로 했으면 좋겠다고 제안교사가 제안을 올렸으나, 연구부에서 쿨메신저를 통한 투표를 진행후 결론이 난 것처럼 처리하여 전체 토론 주제로 되지 못한 안건이 상당수 있었음. 제안교사가 전체 토론을 원했다면, 먼저 제안한 교사에게 투표나 설문으로 진행하겠다고 미리 동의를 구하거나 안내를 했어야 함. \n2.또한 안건을 정리하는 과정에서 일부 안건들이 삭제되었고 논의조차 되지 못하였으며, 일부 교사들은 안건 자체가 어떤 내용이었는지 보지 못한 경우도 있었음.",
    "개선방안": "1. 제안한 교사가 \"전체 토론\"을 했으면 좋겠다고 안건을 올리면, 먼저 제안한 교사에게 투표나 설문으로 진행할 것인지 동의를 구하고, 그래도 토론을 원한다면 시간이 걸리더라도 '전체 토론\"을 하는 것이 타당함. \n2. 평가분석 토론방에 올라온 안건들을 모든 교사가 실시간으로 확인하는 것은 불가능 하므로 담당부서에서 최종 정리한 다음에 전 교직원에게 알릴 필요성이 있음. 정리하는 과정에서 제안을 한 당사자 이외에 다른 사람이 의견을 수정하는 경우가 생길 수 있으므로 이 부분에 대한 보완책도 필요함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "<연구부>\n황혜숙: 1. 연구부에서 수합된 안건을 검토한 후, 1차 설문 또는 토론 진행여부를 검토하고,  2차 부장회의+ 교장, 교감님꼐도 의견을 들은 후 제안자에게도 의견 구하고  동의를 얻도록 하겠습니다. 제안자가 원하는 답변방식 선택 칸을 신설하였으니 표시 해주시면, 최대한 반영하도록 노력하겠습니다. \n2. 최대한 빨리 정리하여 메신저로 재공유하도록 노력하겠습니다. 다만 2학기 말 여러 일정이 많아 신속하지 못하더라도 양해 부탁드립니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 3,
    "제안자": "B교사",
    "사업명": "축제 전날 축제 준비를 위한 시간표 운영",
    "담당부서": "창의체험부",
    "현황_문제점": "2022 개정교육과정 적용인 1학년은 수업 시수의 확보가 중요함. 그런데 전날 5,6,7 교시를 실제로 진행하지 않고 동아리 축제를 진행해 버리는 경우 수업상 진도와 실제 지도의 갭이 생김. 특히 축제 발표를 하지 않는 동아리의 학생들은 수업도 하지 못하고 허송세월을 하게됨.",
    "개선방안": "1. 축제 전날 마지막 2교시를 동아리로 처음부터 계획을 세워 운영함. (기초시간표는 그대로 두고 일일 시간표에서 당일의 동아리 세팅이 가능함)\n2. 축제가 있는 날과 그 전날 시간표를 교체(요일변경) 하여 축제 준비 시간을 확보하는 방법도 있음.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "1. 축제 발표 전날 발표를 하지 않는 동아리의 학생들은 시청각실에서 교사 임장지도 하에 다수의 학생들이 선호하는 영화를 시청하였음. 하교시간을 맞추어야 하므로 이것이 최선이었다고 생각됨. (다른 대안이 있을까요?)\n2. 축제 전날 오후 시간(2-3시간)을 동아리 시수로 잡는 것은 가능. (그러나 해당 요일의 교과수업을 나가지 못한다는 점에서 실질적으로는 별 차이가 없다고 생각됨.)\n3. 축제 전날을 동아리가 있는 날로 잡아, 준비시간을 동아리시수로 잡을 수도 있음. 그러나 이 경우에도 축제 당일 교과수업 시간을 동아리로 운영할 수 밖에 없어 교과수업시간은 줄어들게 되므로 별 차이가 없다고 생각됨.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 4,
    "제안자": "A교사",
    "사업명": "창체시간 요일 변경",
    "담당부서": "교무부 창의체험부",
    "현황_문제점": "1학년 학평 시간표 짜기 어려움. 축제 다음날 수업이 있어 교사,학생 피로감이 큼.\n26학년부터는 1,2학년 학평시간이 모두 5시10분에 끝나므로 수요일 문제가 많음.",
    "개선방안": "수요일 창체 다시 금요일로 다시 변경.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "2026학년도 학사일정 수립시 선생님들의 의견을 들어 변경 검토하겠습니다.(교무부)",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 5,
    "제안자": "A교사",
    "사업명": "6층 여름철 냉방 보강",
    "담당부서": "행정실",
    "현황_문제점": "6층 고3교실 여름철 더위에 취약함.",
    "개선방안": "고3교실 냉방기 보충이 필요하다고 생각됨. 천장 에어컨이나 스텐딩에어컨으로 보강하면 좋을 듯,",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "2024년에도 제안되었던 안건으로 확인됨. 그에 따라 올 여름 선풍기 추가 설치 및 냉방 조기 가동(5시 30분부터 가동)하여 효과를 보임. 냉난방기 추가 설치는 전기용량 증설 및 전기 사용에 대한 장기적인 검토가 필요함",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 6,
    "제안자": "H교사",
    "사업명": "당일 고사 실시 교과의 대표교사는 13시 이후 복무 상신",
    "담당부서": "교무부",
    "현황_문제점": "41조 연수 복무 상신 후 점심식사를 하며 협의회(부서,교과,학년)를 하는 경우, 당일 고사 실시 교과의 교사는 복무는 13시부터로 상신하지만 실제로는 1학년 고사 종료 후 협의회 선생님들과 함께 식당으로 이동하게됨. 상신 내용과 실제 복무가 일치하지 않음.",
    "개선방안": "상신 복무와 실제 복무가 일치할 수 있도록 시간 조정이 필요하다고 생각함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "1. 당일 고사 과목의 정답 공개 후 학생 및 학부모의 이의제기와 민원에 대응한다는 취지로 41조 연수 시간을 당일고사 과목의 대표교사에 한하여 13시 이후로 상신하도록 하였습니다.\n2. 교감 선생님과 협의하고 복무 처리 지침을 검토하여  정하도록 하겠습니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 7,
    "제안자": "H교사",
    "사업명": "3-7 교실 침수",
    "담당부서": "행정실",
    "현황_문제점": "비가 조금만 많이 내리면 3-7 교실이 침수가 되어 학생들이 교실을 이동해야함. 매년 여름마다 반복될 것으로 예상이 됨.",
    "개선방안": "보수 공사가 시급하다고 생각함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "B교사",
    "의견내용": "3-7교실뿐 아니라 그쪽 라인 벽면으로 물이 스며서 바닥에서부터 올라오는 곳이 있음(5층 꿈터쪽). 3-1쪽 계단 중간 창문방향으로도 비가 스며서 올라옴.",
    "담당부서답변": "본교에서 이미 건의하여 2024년도 교육환경개선사업으로 반영되었으나, 석면 해체 작업이 선행되어야 방수 공사 진행이 가능함. 석면 해체 공사는 그 공정상 상당한 기간이 소요되어 학사일정 운영에 차질을 빚을 수 있으며 학교 단위에서 공사 일정을 확정하기 어려움",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 8,
    "제안자": "A교사",
    "사업명": "부담임제",
    "담당부서": "교무부",
    "현황_문제점": "1주 이상(장기)의 담임 부재시  교무부장, 생지부장의 부담임업무는 학교 업무 운영에 어려움이 있다고 생각됨.",
    "개선방안": "1주 이상(장기)의 부담임에서 교무,생지부장은 배려가 필요함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "관련 의견과 학교의 현실을 고려하여 인자위 등 적절한 절차를 거쳐 방안을 모색하겠습니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 9,
    "제안자": "A교사",
    "사업명": "학년부 노후 씽크대 교체",
    "담당부서": "행정실",
    "현황_문제점": "학년부 씽크대가 노후되어 위생상 문제가 있음",
    "개선방안": "교체를 바람.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "2025학년도 집행 가능한 예산 확보 후 개선 필요사항 적극 반영 예정",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 10,
    "제안자": "F교사",
    "사업명": "무인택배함 설치",
    "담당부서": "행정실",
    "현황_문제점": "현재 1층 현관에 위치한 '택배 놓는 곳'은 외부인에게도 택배가 쉽게 노출될 수 있어 개인 정보를 보호하고 분실 위험을 예방하기에 적절하지 않다고 여겨짐.",
    "개선방안": "무인택배함 설치를 희망함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "현재 학교 건물 출입 시 외부인은 안내실에 비치된 방문자 대장에 기록하도록 하고 있으며, CCTV가 설치되어 있음. 향후 교내 보안 및 안전 강화 관리 필요",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 11,
    "제안자": "A교사",
    "사업명": "최성보 업무, 보충시수관련 1,2 학기말정서지원 프로그램 등 이관",
    "담당부서": "교장, 교감",
    "현황_문제점": "25학년도는 1학년만 해당되어 1학년부가 업무를 진행함.",
    "개선방안": "26학년도부터는 총괄부서를 정해야 함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "B교사",
    "의견내용": "1.다른 학교처럼 교육과정부를 신설하여 교육과정부 부장, 교육과정기획, 고교학점제 운영총괄 3인체제를 운영하는 방법",
    "담당부서답변": "교육과정부 신설 필요성에 공감하는 의견이 다수이고 신설에 반대하는 의견이 2건이나, 한 부서 폐지 후 신설의 어려움을 예상하여 대안으로 업무 담당계 신설 대안 의견이 많음. 이에 따라, 내년 교육과정부 신설 보다는 업무 분장에 최성보 담당을 보완 지정하여 운영하고 그 다음년도에 부서 신설을 재검토 예정임.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 12,
    "제안자": "A교사",
    "사업명": "교사식당 개수대 설치",
    "담당부서": "행정실",
    "현황_문제점": "교사식당 오는 길에 있는 수도는 11월말부터 잠가버려 손을 씻을 수 없음",
    "개선방안": "교사 식당내부에서 손을 씻을 수 있도록 개수대 설치요망.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "2025학년도 집행 가능한 예산 확보 및 필요성을 검토하여 설치 예정. 다만, 교직원 식당 내부 설치는 장기적인 검토가 필요함",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 13,
    "제안자": "학교평가\n(학부모)",
    "사업명": "수련회 및 수학여행",
    "담당부서": "1학년부 2학년부",
    "현황_문제점": "고 1,2 수련회 및 수학여행은 학업에 지친 아이들에게 하나의 추억이 됩니다 내년 2학년 학생들의 수학여행 추진해주세요",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "B교사",
    "의견내용": "1. 2학년 수학여행을 지금 추진하기를 어렵습니다.",
    "담당부서답변": "숙박형 체험학습을 재학 중 1회만 진행하길 희망하는 의견도 있어 2024년에 이에 대한 의견 수렴 결과 1학년에서 수련활동, 2학년은 일일형 체험활동을 진행하는 것으로 결정하였습니다. 내년 2학년 학생들은 일일형 체험활동으로 추억을 쌓을 수 있는 프로그램을 마련할 계획입니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 14,
    "제안자": "학교평가\n(학부모)",
    "사업명": "향학당",
    "담당부서": "2학년부",
    "현황_문제점": "향학당 학생들을 좀 더 철저하게 관리 해주셨으면 합니다.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "향학당 학생들을 좀더 철저하게 관리하도록 더욱 노력하겠습니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 15,
    "제안자": "학교평가\n(학생)",
    "사업명": "생활지도",
    "담당부서": "학생생활부",
    "현황_문제점": "체육복 등교일수를 늘려주세요. 체육복 등교 겨울에만 허락해주세요.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "체육복 등교 가능 요일을 늘리어 아침 등교지도 시간에 지도내용에 반영하는 부분에 대해서는 삼주체간의 합의가 필요합니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 16,
    "제안자": "학교평가\n(학생)",
    "사업명": "평가",
    "담당부서": "교무부",
    "현황_문제점": "수업시간까지 외워오는 수행평가가 줄었들면 좋을 것 같습니다",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "B교사",
    "의견내용": "암기 없는 이해는 존재하지 않습니다.",
    "담당부서답변": "과정중심 수행평가의 취지에 맞는 수행평가 계획 및 실시를 지속적으로 안내하겠음.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 17,
    "제안자": "학교평가\n(학생)",
    "사업명": "급식",
    "담당부서": "행정실",
    "현황_문제점": "급식실에서 쥐 나온거 본 적도 있고 급식에서 벌레가 나온 경우가 다분했습니다.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "학교 인근 봉화산에서 각종 동물이 들어오는 경우가 있어 발견 경로를 차단하고 주기적으로 방역 실시 중임.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 18,
    "제안자": "H교사",
    "사업명": "향학당",
    "담당부서": "2학년부",
    "현황_문제점": "학생 1인이 향학당 자리 하나를 독점, 불참 신고서 제출로 자유롭게 결석.",
    "개선방안": "더 많은 학생들이 향학당을 사용할 수 있도록 학생들의 신청 내용을 바탕으로 요일을 조합하여 1자리 2인 배정 등의 시스템으로 변경이 필요함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "B교사",
    "의견내용": "학교 행사, 학교 방과후, 질병 결석(인정 결석 포함)을 제외하고는 학원/개인사유 등의 불참사유를 인정하지 말아야 한다는 의견에 전적으로 동의.",
    "담당부서답변": "1. 불참신청서를 사전에 제출하도록 하는 이유는 학생들이 향학당 불참에 대해 책임감을 갖게 하기 위함임.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 19,
    "제안자": "H교사",
    "사업명": "3학년 몽땅 프로젝트",
    "담당부서": "창의체험부",
    "현황_문제점": "3학년 몽땅 프로젝트 활동지 제출 마감일이 개학일이라 최종보고서 피드백에 어려움이 있었음.",
    "개선방안": "제출 마감일을 개학일 기준 최소 2일 정도의 여유는 줘야 제대로된 피드백이 가능함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "8.18.마감예고 8.19.실마감 8.20지도교사 전달하여 세특 작성, 이후 담임교사에게 전달되기까지 시간이 촉박했음.(내년도에는 일정에 무리없는 선에서 1-2일 더 연장 고려하겠음)",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 20,
    "제안자": "B교사",
    "사업명": "향학당",
    "담당부서": "2학년부",
    "현황_문제점": "1. 향학당에서 공부할 것을 가지고 온다는 핑계로 수업에 늦게 들어오거나, 안들어 오는 경우도 있었음.",
    "개선방안": "1. 일과 시간 중(점심시간 포함) 향학당 사용을 못하게 해야함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "1. 일과 중 운영하고 있지 않음. (점심시간에는 학생들의 희망에 따라 운영하고 있으나, 13:05 모두 퇴실 지도)",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 21,
    "제안자": "B교사",
    "사업명": "학사일정",
    "담당부서": "전체 부서",
    "현황_문제점": "1.2026학년도 학사일정 계획이 다른 학교에 비하여 많이 늦음.",
    "개선방안": "1. 2026학년도 학사일정을 늦어도 12월 초에는 초안이 나와야 함.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "1. 차년도 학사일정 수립 시기를 앞당겨 계약이나 예약등  계획 수립  준비에 차질이 최소화 되도록 노력할 예정임",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 22,
    "제안자": "학교평가\n(학부모)",
    "사업명": "수학여행",
    "담당부서": "1학년부 2학년부",
    "현황_문제점": "내년 수학여행은 (가까운)해외에 대한 의견수렴도 부탁드립니다.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "2025학년도부터 1학년 수련활동만 운영합니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 23,
    "제안자": "학교평가\n(학부모)",
    "사업명": "학생용 정수기",
    "담당부서": "행정실",
    "현황_문제점": "층마다 정수기 설치 부탁드립니다",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "각 층마다 대용량 정수기 설치되어 있음(아리수X)",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 24,
    "제안자": "학교평가\n(학부모)",
    "사업명": "1,2학년 체험활동",
    "담당부서": "1학년부 2학년부",
    "현황_문제점": "1, 2학년 중 숙박 체험활동 1회만 시행",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "제안해 주신 학부모님 의견대로 2025학년도 1학년부터 1,2학년 숙박 체험활동 1회만 시행하고 있습니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 25,
    "제안자": "학교평가\n(학부모)",
    "사업명": "정기고사 실시 일수",
    "담당부서": "교무부",
    "현황_문제점": "2학기 고사일 5일 실시",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "2026학년도 학사일정 계획 할 때 2학기 고사일 모두 5일 로 계획하여 수랍할 예정임",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 26,
    "제안자": "학교평가\n(학부모)",
    "사업명": "정기고사 응시과목수 조절",
    "담당부서": "교무부",
    "현황_문제점": "고사시 과목의 적절한 안배",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "학생들 마다 과목 선택상황에 아주 다양하여 주신 의견을 고려하여 시험 보는 과목의 편중으로 시험에 대한 부담과 불리함이 편중되지 않도록 노력하였으나 아쉬움이 있음.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 27,
    "제안자": "G교사",
    "사업명": "인자 위원 선출방식",
    "담당부서": "교무부",
    "현황_문제점": "인자위원 선출방식이 3그룹으로 나누어 각자 속한 집단에 대해서만 투표를 했는데 이 경우 투표집단이 너무 적어 표심을 정확하게 반영하기 힘들다고 생각합니다.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": true,
    "희망_부서답변": false,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "차년도 인자위원 선출시 선출 방법에 대한 의견을 들어 합리적이고 대표성 있는 선출 방법을 고민하겠음.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 28,
    "제안자": "C교사",
    "사업명": "협의회비 사용",
    "담당부서": "연구부",
    "현황_문제점": "협의회비를 한번에 사용 가능도록 해주세요.",
    "개선방안": "각 교과/부서/교학공에 사정에 따라 협의회비를 학기 관계없이 자유롭게 사용하도록 해주세요.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "당연히 한번에 사용해서 편하게 해드리고 싶습니다만, 병가나 휴직, 학습년제 등의 사유로 1학기와 2학기 각 교과/부서/교학공의 구성원이 달라질 수 있기 때문에 학기별로 사용하도록 한 것입니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 29,
    "제안자": "C교사",
    "사업명": "교내행사-지도교사",
    "담당부서": "인문사회부 창의체험부",
    "현황_문제점": "우리학교에는 다양한 교내 행사가 많은데요. 그 중 지도교사가 필요한 프로그램의 경우 특정 선생님이 많은 팀을 지도하게 되어 업무가 과중해지는 경우가 있습니다.",
    "개선방안": "1. 지도교사가 필요한 교내행사의 경우 교사 1인당 지도 팀을 1팀으로 제한해주세요.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "1. 지독한 독서 클럽은 학생 안내 시 1교사 1팀으로 안내하겠습니다.\n2. 몽땅프로젝트는 교사 1인당 1팀을 원칙으로 하겠습니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 30,
    "제안자": "C교사",
    "사업명": "몽땅프로젝트 운영 방식",
    "담당부서": "창의체험부",
    "현황_문제점": "현재 몽땅프로젝트의 운영 방식에서는 학생들이 맨 처음 신청 시 지도교사를 맡아달라고 찾아온 후에 활동과정에서 지도교사를 만나지 않고, 활동기록지와 최종보고서를 리로스쿨에 업로드하기만 하면 활동을 한 것으로 인정되고 있습니다.",
    "개선방안": "1. 출석부 또는 각 활동기록지에 지도교사의 서명을 받도록 하면 활동 과정을 지도교사가 확인할 수 있을듯 합니다.",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "1. 매회 종합 활동기록지 출력물에 지도교사의 서명을 받아 종이로 제출하도록 하겠습니다. 2. 내용이 부족한 경우 생기부에 기재하지 않도록 학생 및 교사에게 안내하겠습니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": true
  },
  {
    "연번": 31,
    "제안자": "I교사",
    "사업명": "교직원 배식대/식당 별도 운영 여부",
    "담당부서": "행정실",
    "현황_문제점": "[공문내용 요약-학교 급식 운영 협조 안내]\n-'교직원만을 위한 배식대/식당 별도 운영은 미운영'이 원칙임",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": false,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "우리 학교 급식 여건 상 교직원 배식대/식당 별도 운영이 불가피하여 기존 방식대로 운영할 것입니다.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": false
  },
  {
    "연번": 32,
    "제안자": "D교사",
    "사업명": "작품 전시 공간 확보",
    "담당부서": "행정실",
    "현황_문제점": "24년도까지 본교는 갤러리 공간이 있어 미술교과 작품, 사진전, 각 교과 작품 및 우수 과제물 등을 전시하여 학생들의 학습력 향상과 정서적 지원을 해왔습니다.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "겨울방학 기간 화장실 공사가 완료되는 대로 설치 및 작업할 예정임.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": false
  },
  {
    "연번": 33,
    "제안자": "D교사",
    "사업명": "예술교육부 지정",
    "담당부서": "교장, 교감",
    "현황_문제점": "24년도까지 문예체부가 있어 음미체의 단일한 업무처리와 의견 수렴이 원할이 이루어졌습니다.",
    "개선방안": "",
    "희망_전체토론": false,
    "희망_전체설문": false,
    "희망_부서답변": true,
    "의견교사": "",
    "의견내용": "",
    "담당부서답변": "인사자문위원회 자문을 구해 2026학년도 업무분장에 반영 여부를 논의할 예정임.",
    "최종_전체토론": false,
    "최종_전체설문": false,
    "최종_부서답변": false
  }
];

    // SVG 아이콘
    const icons = {
      sparkles: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg>`,
      upload: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>`,
      file: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>`,
      chart: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>`,
      settings: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>`,
      home: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>`,
      folder: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg>`,
      search: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>`,
      close: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>`,
      check: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`,
      users: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>`,
      message: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>`,
      trash: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>`,
      arrow: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>`,
      discussion: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"></path></svg>`,
      survey: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path></svg>`,
      dept: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>`
    };

    // 카테고리 색상 (2025 업데이트)
    const categoryColors = {
      '교무부': { bg: 'from-blue-500 to-indigo-600', light: 'bg-blue-500/20 text-blue-300 border-blue-500/30' },
      '연구부': { bg: 'from-violet-500 to-purple-600', light: 'bg-violet-500/20 text-violet-300 border-violet-500/30' },
      '상담복지부': { bg: 'from-pink-500 to-rose-600', light: 'bg-pink-500/20 text-pink-300 border-pink-500/30' },
      '진로진학부': { bg: 'from-cyan-500 to-teal-600', light: 'bg-cyan-500/20 text-cyan-300 border-cyan-500/30' },
      '학생생활부': { bg: 'from-amber-500 to-orange-600', light: 'bg-amber-500/20 text-amber-300 border-amber-500/30' },
      '체육안전부': { bg: 'from-green-500 to-emerald-600', light: 'bg-green-500/20 text-green-300 border-green-500/30' },
      '창의체험부': { bg: 'from-emerald-500 to-teal-600', light: 'bg-emerald-500/20 text-emerald-300 border-emerald-500/30' },
      '인문사회부': { bg: 'from-indigo-500 to-blue-600', light: 'bg-indigo-500/20 text-indigo-300 border-indigo-500/30' },
      '과학정보부': { bg: 'from-sky-500 to-cyan-600', light: 'bg-sky-500/20 text-sky-300 border-sky-500/30' },
      '3학년부': { bg: 'from-rose-500 to-red-600', light: 'bg-rose-500/20 text-rose-300 border-rose-500/30' },
      '2학년부': { bg: 'from-orange-500 to-amber-600', light: 'bg-orange-500/20 text-orange-300 border-orange-500/30' },
      '1학년부': { bg: 'from-yellow-500 to-amber-600', light: 'bg-yellow-500/20 text-yellow-300 border-yellow-500/30' },
      '행정실': { bg: 'from-slate-500 to-gray-600', light: 'bg-slate-500/20 text-slate-300 border-slate-500/30' },
      '기타': { bg: 'from-gray-500 to-neutral-600', light: 'bg-gray-500/20 text-gray-300 border-gray-500/30' }
    };

    // 상태 관리
    let state = {
      activeTab: 'settings',
      selectedCategory: '전체',
      selectedDept: '전체',
      searchTerm: '',
      selectedItem: null,
      selectedStatsFilter: null, // 'discussion', 'survey', 'answered', 'pending'
      selectedProposer: null, // 제안자 필터
      schoolInfo: { year: '2025', schoolName: '' },
      agendaData: EMBEDDED_DATA,
      isDataLoaded: true
    };

    // LocalStorage
    function loadFromStorage() {
      const saved = localStorage.getItem('educationDashboard2025');
      if (saved) {
        const parsed = JSON.parse(saved);
        state.schoolInfo = parsed.schoolInfo || state.schoolInfo;
        state.agendaData = parsed.agendaData || [];
        state.isDataLoaded = state.agendaData.length > 0;
        if (state.isDataLoaded) state.activeTab = 'overview';
      }
    }

    function saveToStorage() {
      localStorage.setItem('educationDashboard2025', JSON.stringify({
        schoolInfo: state.schoolInfo,
        agendaData: state.agendaData
      }));
    }

    // 부서 색상 가져오기
    function getDeptColor(dept) {
      const normalizedDept = dept.replace(/\n/g, '').trim();
      for (const key of Object.keys(categoryColors)) {
        if (normalizedDept.includes(key)) return categoryColors[key];
      }
      return categoryColors['기타'];
    }

    // 통계 계산
    function getStats() {
      const deptStats = {};
      const proposerStats = {};
      let answeredCount = 0;
      let discussionCount = 0;
      let surveyCount = 0;

      state.agendaData.forEach(item => {
        const dept = item.담당부서 || '미지정';
        deptStats[dept] = (deptStats[dept] || 0) + 1;
        
        if (item.제안자) {
          const name = item.제안자.replace(/\n.*/, '').trim();
          proposerStats[name] = (proposerStats[name] || 0) + 1;
        }
        
        if (item.담당부서답변) answeredCount++;
        if (item.희망_전체토론) discussionCount++;
        if (item.희망_전체설문) surveyCount++;
      });

      return { deptStats, proposerStats, answeredCount, discussionCount, surveyCount };
    }

    // 엑셀 파일 파싱 (2025 양식)
    function parseExcelFile(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: 'array' });
            const sheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
            
            // 헤더 행 찾기
            let headerRowIndex = -1;
            let subHeaderRowIndex = -1;
            
            for (let i = 0; i < Math.min(15, jsonData.length); i++) {
              const row = jsonData[i];
              if (row && row.some(cell => cell && cell.toString().includes('연번'))) {
                headerRowIndex = i;
                subHeaderRowIndex = i + 1;
                break;
              }
            }
            
            if (headerRowIndex === -1) {
              reject(new Error('헤더를 찾을 수 없습니다.'));
              return;
            }
            
            const headers = jsonData[headerRowIndex];
            const subHeaders = jsonData[subHeaderRowIndex] || [];
            const results = [];
            
            // 컬럼 인덱스 매핑 (2025 양식)
            const colIndex = {
              연번: 0,
              제안자: 1,
              사업명: 2,
              담당부서: 3,
              현황_문제점: 4,
              개선방안: 5,
              희망답변방식: 6, // 전체 토론
              희망설문: 7,     // 전체 설문
              희망부서답변: 8, // 담당 부서 답변
              의견교사: 9,
              의견내용: 10,
              담당부서답변: 11,
              최종_전체토론: 12,
              최종_전체설문: 13,
              최종_부서답변: 14
            };
            
            // 헤더에서 정확한 인덱스 찾기
            for (let i = 0; i < headers.length; i++) {
              const h = headers[i] ? headers[i].toString() : '';
              if (h.includes('연번')) colIndex.연번 = i;
              if (h.includes('제안') && h.includes('교원')) colIndex.제안자 = i;
              if (h.includes('사업명') || h.includes('안건')) colIndex.사업명 = i;
              if (h.includes('담당') && h.includes('부서')) colIndex.담당부서 = i;
              if (h.includes('현황') || h.includes('문제점')) colIndex.현황_문제점 = i;
              if (h.includes('개선')) colIndex.개선방안 = i;
              if (h.includes('토론') && !h.includes('최종')) colIndex.토론 = i;
            }
            
            // 데이터 행 시작점 찾기 (예시 행 스킵)
            let dataStartRow = subHeaderRowIndex + 1;
            for (let i = subHeaderRowIndex + 1; i < Math.min(subHeaderRowIndex + 5, jsonData.length); i++) {
              const row = jsonData[i];
              if (row && row[colIndex.연번] && row[colIndex.연번].toString() === '예시') {
                dataStartRow = i + 1;
                break;
              }
            }
            
            // 데이터 파싱
            for (let i = dataStartRow; i < jsonData.length; i++) {
              const row = jsonData[i];
              if (!row || row.length === 0) continue;
              
              const 연번 = row[colIndex.연번];
              if (!연번 || isNaN(parseInt(연번))) continue;
              
              const item = {
                연번: parseInt(연번),
                제안자: (row[colIndex.제안자] || '').toString().trim(),
                사업명: (row[colIndex.사업명] || '').toString().trim(),
                담당부서: (row[colIndex.담당부서] || '').toString().replace(/\n/g, ' ').trim(),
                현황_문제점: (row[colIndex.현황_문제점] || '').toString().trim(),
                개선방안: (row[colIndex.개선방안] || '').toString().trim(),
                희망_전체토론: row[6] && row[6].toString().toUpperCase().includes('O'),
                희망_전체설문: row[7] && row[7].toString().toUpperCase().includes('O'),
                희망_부서답변: row[8] && row[8].toString().toUpperCase().includes('O'),
                의견교사: (row[9] || '').toString().trim(),
                의견내용: (row[10] || '').toString().trim(),
                담당부서답변: (row[11] || '').toString().trim(),
                최종_전체토론: row[12] && row[12].toString().toUpperCase().includes('O'),
                최종_전체설문: row[13] && row[13].toString().toUpperCase().includes('O'),
                최종_부서답변: row[14] && row[14].toString().toUpperCase().includes('O')
              };
              
              if (item.사업명) results.push(item);
            }
            
            resolve(results);
          } catch (error) {
            reject(error);
          }
        };
        reader.onerror = () => reject(new Error('파일 읽기 실패'));
        reader.readAsArrayBuffer(file);
      });
    }

    // 필터링된 데이터
    function getFilteredData() {
      return state.agendaData.filter(item => {
        const matchSearch = !state.searchTerm || 
          item.사업명.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
          item.제안자.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
          item.현황_문제점.toLowerCase().includes(state.searchTerm.toLowerCase());
        
        const matchDept = state.selectedDept === '전체' || 
          item.담당부서.includes(state.selectedDept);
        
        const matchProposer = !state.selectedProposer ||
          item.제안자.replace(/\n.*/, '').trim() === state.selectedProposer;
        
        return matchSearch && matchDept && matchProposer;
      });
    }

    // 탭 렌더링
    function renderTab(id, label, icon) {
      const isActive = state.activeTab === id;
      return `
        <button onclick="setTab('${id}')" 
          class="tab-btn flex items-center gap-2 px-5 py-4 text-sm font-medium whitespace-nowrap ${isActive ? 'active' : ''}">
          ${icon}
          <span>${label}</span>
        </button>
      `;
    }

    // 설정 페이지
    function renderSettings() {
      return `
        <div class="max-w-2xl mx-auto space-y-8 animate-fade-up">
          <!-- 기본 정보 -->
          <div class="glass-card rounded-2xl p-8">
            <h2 class="text-xl font-bold mb-6 flex items-center gap-3">
              <div class="w-10 h-10 rounded-xl gold-gradient flex items-center justify-center">
                ${icons.settings}
              </div>
              <span>기본 정보 설정</span>
            </h2>
            
            <div class="space-y-5">
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">학년도</label>
                <input type="text" id="yearInput" value="${state.schoolInfo.year}"
                  class="w-full px-4 py-3 rounded-xl glass border border-white/10 focus:border-amber-500/50 focus:outline-none transition-all text-white"
                  placeholder="예: 2025">
              </div>
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">학교명</label>
                <input type="text" id="schoolNameInput" value="${state.schoolInfo.schoolName}"
                  class="w-full px-4 py-3 rounded-xl glass border border-white/10 focus:border-amber-500/50 focus:outline-none transition-all text-white"
                  placeholder="예: 원묵고등학교">
              </div>
              <button onclick="saveSchoolInfo()" class="btn-gold w-full py-3 rounded-xl font-semibold">
                <span>정보 저장</span>
              </button>
            </div>
          </div>

          <!-- 파일 업로드 -->
          <div class="glass-card rounded-2xl p-8">
            <h2 class="text-xl font-bold mb-6 flex items-center gap-3">
              <div class="w-10 h-10 rounded-xl gold-gradient flex items-center justify-center">
                ${icons.file}
              </div>
              <span>데이터 불러오기</span>
            </h2>
            
            <div id="dropZone" class="drop-zone rounded-2xl p-12 cursor-pointer text-center">
              <div class="text-amber-400 mb-4 flex justify-center">
                ${icons.upload}
              </div>
              <p class="text-white font-medium mb-2">엑셀 파일을 드래그하거나 클릭하세요</p>
              <p class="text-slate-400 text-sm">2025학년도 교육사업평가분석토론회 양식</p>
              <input type="file" id="fileInput" accept=".xlsx,.xls" class="hidden">
            </div>
            
            ${state.isDataLoaded ? `
              <div class="mt-6 p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/30">
                <div class="flex items-center gap-3">
                  <div class="status-dot status-answered"></div>
                  <span class="text-emerald-400">총 ${state.agendaData.length}건의 안건이 로드되었습니다</span>
                </div>
              </div>
            ` : ''}
          </div>

          <!-- 데이터 초기화 -->
          ${state.isDataLoaded ? `
            <div class="glass-card rounded-2xl p-8">
              <h2 class="text-xl font-bold mb-4 text-rose-400">데이터 초기화</h2>
              <p class="text-slate-400 text-sm mb-6">모든 데이터가 삭제되며 복구할 수 없습니다.</p>
              <button onclick="resetData()" class="flex items-center justify-center gap-2 w-full py-3 rounded-xl border border-rose-500/50 text-rose-400 hover:bg-rose-500/10 transition-all">
                ${icons.trash}
                <span>데이터 초기화</span>
              </button>
            </div>
          ` : ''}
        </div>
      `;
    }

    // 개괄 페이지
    function renderOverview(stats) {
      const totalItems = state.agendaData.length;
      const answeredRate = totalItems > 0 ? Math.round((stats.answeredCount / totalItems) * 100) : 0;
      
      // 부서별 통계 (상위 6개)
      const deptEntries = Object.entries(stats.deptStats)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 8);
      
      const maxDeptCount = Math.max(...deptEntries.map(([_, count]) => count), 1);

      return `
        <div class="space-y-8">
          <!-- 헤더 카드 -->
          <div class="glass-card rounded-3xl p-8 gold-glow animate-fade-up">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
              <div>
                <p class="text-amber-400/80 text-sm font-medium tracking-wider uppercase mb-2">Dashboard Overview</p>
                <h2 class="text-3xl md:text-4xl font-bold">
                  <span class="gold-text font-display">${totalItems}</span>
                  <span class="text-white ml-2">안건이 수합되었습니다</span>
                </h2>
              </div>
              <div class="flex gap-6">
                <div class="text-center">
                  <div class="text-3xl font-bold text-emerald-400">${stats.answeredCount}</div>
                  <div class="text-xs text-slate-400 mt-1">답변 완료</div>
                </div>
                <div class="text-center">
                  <div class="text-3xl font-bold text-blue-400">${stats.discussionCount}</div>
                  <div class="text-xs text-slate-400 mt-1">전체 토론</div>
                </div>
                <div class="text-center">
                  <div class="text-3xl font-bold text-purple-400">${stats.surveyCount}</div>
                  <div class="text-xs text-slate-400 mt-1">전체 설문</div>
                </div>
              </div>
            </div>
            
            <!-- 답변 진행률 -->
            <div class="mt-8">
              <div class="flex justify-between items-center mb-3">
                <span class="text-sm text-slate-400">답변 진행률</span>
                <span class="text-sm font-semibold text-amber-400">${answeredRate}%</span>
              </div>
              <div class="progress-track h-3">
                <div class="progress-fill h-full" style="width: ${answeredRate}%"></div>
              </div>
            </div>
          </div>

          <!-- 차트 섹션 -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- 파이차트 -->
            <div class="glass-card rounded-2xl p-6 animate-fade-up stagger-1">
              <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                ${icons.chart}
                <span>부서별 안건 분포</span>
              </h3>
              <div class="relative">
                <canvas id="deptPieChart" style="max-height: 320px;"></canvas>
              </div>
            </div>

            <!-- 최근 안건 -->
            <div class="glass-card rounded-2xl p-6 animate-fade-up stagger-2">
              <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                ${icons.folder}
                <span>최근 등록 안건</span>
              </h3>
              <div class="space-y-3">
                ${state.agendaData.slice(-5).reverse().map(item => {
                  const color = getDeptColor(item.담당부서);
                  return `
                    <div class="p-4 rounded-xl glass hover:bg-white/5 cursor-pointer transition-all" onclick="showDetail(${item.연번})">
                      <div class="flex items-start justify-between gap-3">
                        <div class="flex-1 min-w-0">
                          <p class="font-medium text-white truncate">${item.사업명}</p>
                          <p class="text-xs text-slate-400 mt-1">${item.제안자.replace(/\n.*/, '')}</p>
                        </div>
                        <span class="category-tag ${color.light} border shrink-0">${item.담당부서.split('\n')[0]}</span>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </div>
          </div>

          <!-- 답변 현황 파이차트 -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="glass-card rounded-2xl p-6 animate-fade-up stagger-3">
              <h3 class="text-lg font-bold mb-4 text-center">답변 현황</h3>
              <div class="relative" style="height: 200px;">
                <canvas id="answerPieChart"></canvas>
              </div>
              <div class="flex justify-center gap-6 mt-4">
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 rounded-full bg-emerald-500"></div>
                  <span class="text-xs text-slate-400">완료 ${stats.answeredCount}</span>
                </div>
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 rounded-full bg-amber-500"></div>
                  <span class="text-xs text-slate-400">대기 ${totalItems - stats.answeredCount}</span>
                </div>
              </div>
            </div>

            <div class="glass-card rounded-2xl p-6 animate-fade-up stagger-4">
              <h3 class="text-lg font-bold mb-4 text-center">희망 답변 방식</h3>
              <div class="relative" style="height: 200px;">
                <canvas id="responsePieChart"></canvas>
              </div>
              <div class="flex justify-center gap-4 mt-4 flex-wrap">
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                  <span class="text-xs text-slate-400">토론 ${stats.discussionCount}</span>
                </div>
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 rounded-full bg-purple-500"></div>
                  <span class="text-xs text-slate-400">설문 ${stats.surveyCount}</span>
                </div>
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 rounded-full bg-teal-500"></div>
                  <span class="text-xs text-slate-400">부서 ${totalItems - stats.discussionCount - stats.surveyCount}</span>
                </div>
              </div>
            </div>

            <!-- 빠른 액션 -->
            <div class="glass-card rounded-2xl p-6 animate-fade-up stagger-5 flex flex-col justify-center">
              <h3 class="text-lg font-bold mb-4 text-center">빠른 액션</h3>
              <div class="space-y-3">
                <button onclick="setTab('list')" class="w-full glass rounded-xl p-4 text-left hover:bg-white/5 transition-all group flex items-center gap-3">
                  <div class="w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center text-amber-400 group-hover:scale-110 transition-transform">
                    ${icons.folder}
                  </div>
                  <div>
                    <p class="font-medium text-white">전체 안건</p>
                    <p class="text-xs text-slate-400">목록 보기</p>
                  </div>
                </button>
                <button onclick="setTab('stats')" class="w-full glass rounded-xl p-4 text-left hover:bg-white/5 transition-all group flex items-center gap-3">
                  <div class="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center text-blue-400 group-hover:scale-110 transition-transform">
                    ${icons.chart}
                  </div>
                  <div>
                    <p class="font-medium text-white">상세 통계</p>
                    <p class="text-xs text-slate-400">분석 보기</p>
                  </div>
                </button>
              </div>
            </div>
          </div>

          <!-- 총평: 교육 혁신 인사이트 -->
          <div class="glass-card rounded-3xl p-8 animate-fade-up stagger-4 relative overflow-hidden">
            <!-- 배경 장식 -->
            <div class="absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-amber-500/10 to-transparent rounded-full blur-3xl"></div>
            <div class="absolute bottom-0 left-0 w-48 h-48 bg-gradient-to-tr from-blue-500/10 to-transparent rounded-full blur-3xl"></div>
            
            <div class="relative">
              <!-- 헤더 -->
              <div class="flex items-center gap-4 mb-8">
                <div class="w-14 h-14 rounded-2xl gold-gradient flex items-center justify-center gold-glow">
                  <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                  </svg>
                </div>
                <div>
                  <h2 class="text-2xl font-bold gold-text font-display">교육 혁신 인사이트</h2>
                  <p class="text-slate-400 text-sm mt-1">Education Innovation Insights</p>
                </div>
              </div>

              <!-- 핵심 키워드 -->
              <div class="mb-8">
                <div class="flex items-center gap-2 mb-4">
                  <div class="w-1.5 h-6 rounded-full bg-gradient-to-b from-amber-400 to-orange-500"></div>
                  <h3 class="text-lg font-bold text-white">핵심 키워드</h3>
                </div>
                <div class="glass rounded-2xl p-5">
                  <div class="flex flex-wrap gap-3 mb-4">
                    <span class="px-4 py-2 rounded-full bg-amber-500/20 text-amber-300 border border-amber-500/30 font-medium">운영 효율화</span>
                    <span class="px-4 py-2 rounded-full bg-emerald-500/20 text-emerald-300 border border-emerald-500/30 font-medium">교육 환경 개선</span>
                    <span class="px-4 py-2 rounded-full bg-blue-500/20 text-blue-300 border border-blue-500/30 font-medium">학사 일정 및 프로그램</span>
                  </div>
                  <p class="text-slate-300 leading-relaxed">
                    이는 학교의 근본적인 기능과 구성원의 만족도를 높이기 위한 핵심 영역임을 시사합니다.
                  </p>
                </div>
              </div>

              <!-- 주요 트렌드 -->
              <div class="mb-8">
                <div class="flex items-center gap-2 mb-4">
                  <div class="w-1.5 h-6 rounded-full bg-gradient-to-b from-blue-400 to-indigo-500"></div>
                  <h3 class="text-lg font-bold text-white">주요 트렌드</h3>
                </div>
                <div class="grid md:grid-cols-3 gap-4">
                  <div class="glass rounded-2xl p-5 border-t-2 border-rose-500/50">
                    <div class="flex items-center gap-2 mb-3">
                      <span class="w-8 h-8 rounded-lg bg-rose-500/20 flex items-center justify-center text-rose-400 font-bold">1</span>
                      <span class="font-semibold text-white text-sm">행정 효율화</span>
                    </div>
                    <p class="text-slate-400 text-sm leading-relaxed">
                      행정 및 업무 절차의 간소화와 명확화를 통해 교직원의 업무 부담을 경감하고 효율성을 높이고자 합니다.
                    </p>
                  </div>
                  <div class="glass rounded-2xl p-5 border-t-2 border-emerald-500/50">
                    <div class="flex items-center gap-2 mb-3">
                      <span class="w-8 h-8 rounded-lg bg-emerald-500/20 flex items-center justify-center text-emerald-400 font-bold">2</span>
                      <span class="font-semibold text-white text-sm">복지 증진</span>
                    </div>
                    <p class="text-slate-400 text-sm leading-relaxed">
                      학교 시설 및 교직원·학생 복지 증진에 대한 강력한 요구가 다수 확인됩니다.
                    </p>
                  </div>
                  <div class="glass rounded-2xl p-5 border-t-2 border-blue-500/50">
                    <div class="flex items-center gap-2 mb-3">
                      <span class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center text-blue-400 font-bold">3</span>
                      <span class="font-semibold text-white text-sm">학사 체계화</span>
                    </div>
                    <p class="text-slate-400 text-sm leading-relaxed">
                      학생 활동 및 학사 운영의 체계화를 통해 교육의 질을 높이고 학생들의 참여를 극대화하려는 노력이 엿보입니다.
                    </p>
                  </div>
                </div>
              </div>

              <!-- 총평 및 제언 -->
              <div>
                <div class="flex items-center gap-2 mb-4">
                  <div class="w-1.5 h-6 rounded-full bg-gradient-to-b from-violet-400 to-purple-500"></div>
                  <h3 class="text-lg font-bold text-white">총평 및 제언</h3>
                </div>
                <div class="glass rounded-2xl p-6 border-l-4 border-amber-500/50 bg-gradient-to-r from-amber-500/5 to-transparent">
                  <p class="text-slate-300 leading-loose">
                    <span class="text-amber-400 font-medium">원묵고등학교 구성원 여러분</span>의 학교 발전을 향한 깊은 관심과 노고에 경의를 표합니다. 
                    제시된 안건들은 학교 운영의 다양한 측면에서 실질적인 개선을 모색하려는 적극적인 의지를 보여줍니다.
                  </p>
                  <p class="text-slate-300 leading-loose mt-4">
                    이번 토론회가 단순한 의견 개진을 넘어, 각 부서의 <span class="text-blue-400 font-medium">데이터를 기반으로 한 합리적인 논의</span>와 
                    <span class="text-emerald-400 font-medium">상호 이해</span>를 바탕으로 진행되기를 기대합니다. 
                    단기적인 불편 해소와 더불어 <span class="text-violet-400 font-medium">장기적인 교육 혁신</span>을 위한 협력적 대안을 도출하는 
                    생산적인 시간이 되기를 진심으로 제언합니다.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // 목록 페이지
    function renderList() {
      const filteredData = getFilteredData();
      const depts = [...new Set(state.agendaData.map(item => item.담당부서))].sort();

      return `
        <div class="space-y-6 animate-fade-up">
          <!-- 필터 -->
          <div class="glass-card rounded-2xl p-6">
            <div class="flex flex-col md:flex-row gap-4">
              <!-- 검색 -->
              <div class="flex-1 relative">
                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400">
                  ${icons.search}
                </div>
                <input type="text" id="searchInput" value="${state.searchTerm}"
                  placeholder="안건명, 제안자, 내용으로 검색..."
                  class="w-full pl-12 pr-4 py-3 rounded-xl glass border border-white/10 focus:border-amber-500/50 focus:outline-none transition-all text-white">
              </div>
              
              <!-- 부서 필터 -->
              <select id="deptSelect" 
                class="px-4 py-3 rounded-xl glass border border-white/10 focus:border-amber-500/50 focus:outline-none transition-all text-white appearance-none pr-10 min-w-[160px]">
                <option value="전체" ${state.selectedDept === '전체' ? 'selected' : ''}>전체 부서</option>
                ${depts.map(dept => `
                  <option value="${dept}" ${state.selectedDept === dept ? 'selected' : ''}>${dept}</option>
                `).join('')}
              </select>
              
              ${state.searchTerm || state.selectedDept !== '전체' || state.selectedProposer ? `
                <button onclick="clearFilters()" class="px-4 py-3 rounded-xl border border-white/20 hover:bg-white/5 transition-all text-slate-400 hover:text-white">
                  필터 초기화
                </button>
              ` : ''}
            </div>
            
            <!-- 제안자 필터 태그 -->
            ${state.selectedProposer ? `
              <div class="mt-4 flex items-center gap-3">
                <span class="text-sm text-slate-400">제안자 필터:</span>
                <div class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-amber-500/20 border border-amber-500/30">
                  <span class="text-amber-300 font-medium">${state.selectedProposer}</span>
                  <button onclick="clearProposerOnly()" class="text-amber-400 hover:text-amber-300 transition-colors">
                    ${icons.close}
                  </button>
                </div>
              </div>
            ` : ''}
            
            <div class="mt-4 flex items-center gap-2 text-sm text-slate-400">
              <span>총 ${filteredData.length}건</span>
              ${filteredData.length !== state.agendaData.length ? `
                <span class="text-amber-400">(필터 적용됨)</span>
              ` : ''}
            </div>
          </div>

          <!-- 목록 -->
          <div class="grid gap-4">
            ${filteredData.map((item, index) => {
              const color = getDeptColor(item.담당부서);
              const hasAnswer = !!item.담당부서답변;
              const hasOpinion = !!item.의견내용;
              
              return `
                <div class="glass-card rounded-2xl p-6 cursor-pointer animate-fade-up" 
                     style="animation-delay: ${index * 0.05}s"
                     onclick="showDetail(${item.연번})">
                  <div class="flex flex-col md:flex-row md:items-start gap-4">
                    <!-- 번호 -->
                    <div class="w-12 h-12 rounded-xl gold-gradient flex items-center justify-center font-bold text-black shrink-0">
                      ${item.연번}
                    </div>
                    
                    <!-- 내용 -->
                    <div class="flex-1 min-w-0">
                      <div class="flex flex-wrap items-center gap-2 mb-2">
                        <h3 class="font-bold text-lg text-white">${item.사업명}</h3>
                        <span class="category-tag ${color.light} border">${item.담당부서.split('\n')[0]}</span>
                      </div>
                      
                      <p class="text-slate-400 text-sm line-clamp-2 mb-3">${item.현황_문제점 || item.개선방안 || ''}</p>
                      
                      <div class="flex flex-wrap items-center gap-3">
                        <span class="text-xs text-slate-500">제안: ${item.제안자.replace(/\n.*/, '')}</span>
                        
                        <!-- 희망 답변 방식 -->
                        <div class="flex gap-1">
                          ${item.희망_전체토론 ? `<span class="response-type discussion">${icons.discussion} 토론</span>` : ''}
                          ${item.희망_전체설문 ? `<span class="response-type survey">${icons.survey} 설문</span>` : ''}
                          ${item.희망_부서답변 ? `<span class="response-type dept">${icons.dept} 부서</span>` : ''}
                        </div>
                      </div>
                    </div>
                    
                    <!-- 상태 -->
                    <div class="flex items-center gap-3 shrink-0">
                      ${hasOpinion ? `
                        <div class="flex items-center gap-1 text-xs text-blue-400">
                          ${icons.message}
                          <span>의견</span>
                        </div>
                      ` : ''}
                      ${hasAnswer ? `
                        <div class="flex items-center gap-1 text-xs text-emerald-400">
                          ${icons.check}
                          <span>답변완료</span>
                        </div>
                      ` : `
                        <div class="flex items-center gap-1 text-xs text-amber-400">
                          <div class="status-dot status-pending"></div>
                          <span>대기중</span>
                        </div>
                      `}
                      <div class="text-slate-500">
                        ${icons.arrow}
                      </div>
                    </div>
                  </div>
                </div>
              `;
            }).join('')}
          </div>
          
          ${filteredData.length === 0 ? `
            <div class="text-center py-16">
              <div class="text-slate-500 mb-4">
                ${icons.search}
              </div>
              <p class="text-slate-400">검색 결과가 없습니다</p>
            </div>
          ` : ''}
        </div>
      `;
    }

    // 통계 페이지
    let currentProposerList = []; // 현재 제안자 목록 저장
    
    function renderStats(stats) {
      const deptEntries = Object.entries(stats.deptStats).sort((a, b) => b[1] - a[1]);
      const proposerEntries = Object.entries(stats.proposerStats).sort((a, b) => b[1] - a[1]).slice(0, 10);
      const maxDeptCount = Math.max(...deptEntries.map(([_, count]) => count), 1);
      const maxProposerCount = Math.max(...proposerEntries.map(([_, count]) => count), 1);
      
      // 전역 변수에 제안자 목록 저장
      currentProposerList = proposerEntries.map(([name]) => name);
      
      const totalItems = state.agendaData.length;
      const pendingCount = totalItems - stats.answeredCount;

      // 필터된 안건 가져오기
      const getFilteredItems = () => {
        switch(state.selectedStatsFilter) {
          case 'discussion':
            return state.agendaData.filter(item => item.희망_전체토론);
          case 'survey':
            return state.agendaData.filter(item => item.희망_전체설문);
          case 'answered':
            return state.agendaData.filter(item => item.담당부서답변);
          case 'pending':
            return state.agendaData.filter(item => !item.담당부서답변);
          default:
            return [];
        }
      };

      const filteredItems = getFilteredItems();
      
      const filterLabels = {
        'discussion': '전체 토론 희망 안건',
        'survey': '전체 설문 희망 안건',
        'answered': '답변 완료 안건',
        'pending': '답변 대기 안건'
      };

      return `
        <div class="space-y-8 animate-fade-up">
          <!-- 요약 카드 -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="glass-card rounded-2xl p-6 text-center">
              <div class="text-4xl font-bold gold-text font-display mb-2">${state.agendaData.length}</div>
              <div class="text-sm text-slate-400">총 안건</div>
            </div>
            <button onclick="toggleStatsFilter('answered')" class="glass-card rounded-2xl p-6 text-center transition-all hover:scale-105 ${state.selectedStatsFilter === 'answered' ? 'ring-2 ring-emerald-500 bg-emerald-500/10' : ''}">
              <div class="text-4xl font-bold text-emerald-400 font-display mb-2">${stats.answeredCount}</div>
              <div class="text-sm text-slate-400">답변 완료</div>
              <div class="text-xs text-emerald-400/70 mt-1">클릭하여 보기</div>
            </button>
            <button onclick="toggleStatsFilter('discussion')" class="glass-card rounded-2xl p-6 text-center transition-all hover:scale-105 ${state.selectedStatsFilter === 'discussion' ? 'ring-2 ring-blue-500 bg-blue-500/10' : ''}">
              <div class="text-4xl font-bold text-blue-400 font-display mb-2">${stats.discussionCount}</div>
              <div class="text-sm text-slate-400">전체 토론 희망</div>
              <div class="text-xs text-blue-400/70 mt-1">클릭하여 보기</div>
            </button>
            <button onclick="toggleStatsFilter('survey')" class="glass-card rounded-2xl p-6 text-center transition-all hover:scale-105 ${state.selectedStatsFilter === 'survey' ? 'ring-2 ring-purple-500 bg-purple-500/10' : ''}">
              <div class="text-4xl font-bold text-purple-400 font-display mb-2">${stats.surveyCount}</div>
              <div class="text-sm text-slate-400">전체 설문 희망</div>
              <div class="text-xs text-purple-400/70 mt-1">클릭하여 보기</div>
            </button>
          </div>

          <!-- 필터된 안건 목록 -->
          ${state.selectedStatsFilter ? `
            <div class="glass-card rounded-2xl p-6 animate-fade-up">
              <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-bold flex items-center gap-3">
                  <span class="w-2 h-8 rounded-full ${
                    state.selectedStatsFilter === 'discussion' ? 'bg-blue-500' :
                    state.selectedStatsFilter === 'survey' ? 'bg-purple-500' :
                    state.selectedStatsFilter === 'answered' ? 'bg-emerald-500' : 'bg-amber-500'
                  }"></span>
                  ${filterLabels[state.selectedStatsFilter]}
                  <span class="text-sm font-normal text-slate-400">(${filteredItems.length}건)</span>
                </h3>
                <button onclick="clearStatsFilter()" class="px-4 py-2 rounded-lg glass hover:bg-white/10 transition-all text-sm text-slate-400 hover:text-white flex items-center gap-2">
                  ${icons.close}
                  닫기
                </button>
              </div>
              
              <div class="space-y-3 max-h-96 overflow-y-auto custom-scrollbar pr-2">
                ${filteredItems.length > 0 ? filteredItems.map(item => {
                  const color = getDeptColor(item.담당부서);
                  return `
                    <div class="p-4 rounded-xl glass hover:bg-white/5 cursor-pointer transition-all" onclick="showDetail(${item.연번})">
                      <div class="flex items-start gap-4">
                        <div class="w-10 h-10 rounded-lg gold-gradient flex items-center justify-center font-bold text-black shrink-0 text-sm">
                          ${item.연번}
                        </div>
                        <div class="flex-1 min-w-0">
                          <div class="flex flex-wrap items-center gap-2 mb-1">
                            <h4 class="font-medium text-white">${item.사업명}</h4>
                            <span class="category-tag ${color.light} border text-xs">${item.담당부서.split('\n')[0]}</span>
                          </div>
                          <p class="text-sm text-slate-400 line-clamp-2">${item.현황_문제점 || item.개선방안 || ''}</p>
                          <div class="flex items-center gap-3 mt-2">
                            <span class="text-xs text-slate-500">제안: ${item.제안자.replace(/\n.*/, '')}</span>
                            ${item.담당부서답변 ? `
                              <span class="flex items-center gap-1 text-xs text-emerald-400">
                                ${icons.check} 답변완료
                              </span>
                            ` : ''}
                          </div>
                        </div>
                        <div class="text-slate-500 shrink-0">
                          ${icons.arrow}
                        </div>
                      </div>
                    </div>
                  `;
                }).join('') : `
                  <div class="text-center py-8 text-slate-400">
                    해당 조건의 안건이 없습니다.
                  </div>
                `}
              </div>
            </div>
          ` : ''}

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- 부서별 통계 -->
            <div class="glass-card rounded-2xl p-6">
              <h3 class="text-lg font-bold mb-6">부서별 안건 분포</h3>
              <div class="space-y-4">
                ${deptEntries.map(([dept, count]) => {
                  const color = getDeptColor(dept);
                  const percentage = Math.round((count / maxDeptCount) * 100);
                  return `
                    <div class="cursor-pointer hover:bg-white/5 p-2 -mx-2 rounded-lg transition-all" onclick="filterAndShowList('${dept}')">
                      <div class="flex justify-between items-center mb-2">
                        <span class="text-sm text-slate-300">${dept}</span>
                        <span class="text-sm font-semibold text-amber-400">${count}건 (${Math.round((count / state.agendaData.length) * 100)}%)</span>
                      </div>
                      <div class="progress-track h-3">
                        <div class="h-full rounded-full bg-gradient-to-r ${color.bg}" style="width: ${percentage}%"></div>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </div>

            <!-- 제안자별 통계 -->
            <div class="glass-card rounded-2xl p-6">
              <h3 class="text-lg font-bold mb-6">제안자별 안건 현황 (TOP 10)</h3>
              <div class="space-y-4">
                ${proposerEntries.map(([name, count], index) => {
                  const percentage = Math.round((count / maxProposerCount) * 100);
                  const isSelected = state.selectedProposer === name;
                  return `
                    <div class="flex items-center gap-4 cursor-pointer p-2 -mx-2 rounded-lg transition-all hover:bg-white/5 ${isSelected ? 'bg-amber-500/10 ring-1 ring-amber-500/50' : ''}" onclick="selectProposerByIndex(${index})">
                      <div class="w-8 h-8 rounded-lg ${index < 3 ? 'gold-gradient' : 'bg-white/10'} flex items-center justify-center text-sm font-bold ${index < 3 ? 'text-black' : 'text-white'}">
                        ${index + 1}
                      </div>
                      <div class="flex-1">
                        <div class="flex justify-between items-center mb-1">
                          <span class="text-sm text-slate-300 ${isSelected ? 'text-amber-300 font-medium' : ''}">${name}</span>
                          <div class="flex items-center gap-2">
                            <span class="text-sm font-semibold text-amber-400">${count}건</span>
                            <span class="text-xs text-slate-500">클릭</span>
                          </div>
                        </div>
                        <div class="progress-track h-2">
                          <div class="progress-fill h-full" style="width: ${percentage}%"></div>
                        </div>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // 모달 렌더링
    function renderModal() {
      if (!state.selectedItem) return '';
      
      const item = state.selectedItem;
      const color = getDeptColor(item.담당부서);
      
      return `
        <div class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay" onclick="closeModal(event)">
          <div class="glass-strong rounded-3xl max-w-3xl w-full max-h-[90vh] overflow-hidden animate-fade-up" onclick="event.stopPropagation()">
            <!-- 헤더 -->
            <div class="p-6 border-b border-white/10 bg-gradient-to-r ${color.bg}">
              <div class="flex items-start justify-between">
                <div class="flex items-center gap-4">
                  <div class="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center font-bold text-2xl">
                    ${item.연번}
                  </div>
                  <div>
                    <h2 class="text-xl font-bold text-white">${item.사업명}</h2>
                    <p class="text-white/80 text-sm mt-1">${item.담당부서}</p>
                  </div>
                </div>
                <button onclick="closeModal()" class="w-10 h-10 rounded-xl bg-white/20 hover:bg-white/30 flex items-center justify-center transition-all">
                  ${icons.close}
                </button>
              </div>
            </div>
            
            <!-- 본문 -->
            <div class="p-6 overflow-y-auto custom-scrollbar max-h-[calc(90vh-200px)] space-y-6">
              <!-- 제안자 & 희망 답변 방식 -->
              <div class="flex flex-wrap items-center gap-4">
                <div class="flex items-center gap-2">
                  ${icons.users}
                  <span class="text-slate-400">제안:</span>
                  <span class="text-white font-medium">${item.제안자}</span>
                </div>
                <div class="flex gap-2">
                  ${item.희망_전체토론 ? `<span class="response-type discussion">${icons.discussion} 전체 토론</span>` : ''}
                  ${item.희망_전체설문 ? `<span class="response-type survey">${icons.survey} 전체 설문</span>` : ''}
                  ${item.희망_부서답변 ? `<span class="response-type dept">${icons.dept} 부서 답변</span>` : ''}
                </div>
              </div>
              
              <!-- 현황 및 문제점 -->
              ${item.현황_문제점 ? `
                <div>
                  <h3 class="text-sm font-semibold text-amber-400 mb-3">2025년 진행 현황 및 문제점</h3>
                  <div class="glass rounded-xl p-4">
                    <p class="text-slate-300 leading-relaxed whitespace-pre-wrap">${item.현황_문제점}</p>
                  </div>
                </div>
              ` : ''}
              
              <!-- 개선방안 -->
              ${item.개선방안 ? `
                <div>
                  <h3 class="text-sm font-semibold text-emerald-400 mb-3">개선방안 제안</h3>
                  <div class="glass rounded-xl p-4">
                    <p class="text-slate-300 leading-relaxed whitespace-pre-wrap">${item.개선방안}</p>
                  </div>
                </div>
              ` : ''}
              
              <!-- 토론 의견 -->
              ${item.의견내용 ? `
                <div>
                  <h3 class="text-sm font-semibold text-blue-400 mb-3">제안에 대한 의견</h3>
                  <div class="opinion-card">
                    <p class="text-xs text-slate-500 mb-2">${item.의견교사}</p>
                    <p class="text-slate-300 leading-relaxed whitespace-pre-wrap">${item.의견내용}</p>
                  </div>
                </div>
              ` : ''}
              
              <!-- 담당 부서 답변 -->
              ${item.담당부서답변 ? `
                <div>
                  <h3 class="text-sm font-semibold text-violet-400 mb-3">담당 부서 답변</h3>
                  <div class="glass rounded-xl p-4 border-l-4 border-violet-500">
                    <p class="text-slate-300 leading-relaxed whitespace-pre-wrap">${item.담당부서답변}</p>
                  </div>
                </div>
              ` : `
                <div class="glass rounded-xl p-4 text-center">
                  <div class="flex items-center justify-center gap-2 text-amber-400">
                    <div class="status-dot status-pending"></div>
                    <span>담당 부서 답변 대기 중</span>
                  </div>
                </div>
              `}
              
              <!-- 최종 답변 방식 -->
              ${(item.최종_전체토론 || item.최종_전체설문 || item.최종_부서답변) ? `
                <div class="pt-4 border-t border-white/10">
                  <h3 class="text-xs font-semibold text-slate-500 mb-3">최종 답변 방식 (연구부 결정)</h3>
                  <div class="flex gap-2">
                    ${item.최종_전체토론 ? `<span class="response-type discussion">${icons.discussion} 전체 토론</span>` : ''}
                    ${item.최종_전체설문 ? `<span class="response-type survey">${icons.survey} 전체 설문</span>` : ''}
                    ${item.최종_부서답변 ? `<span class="response-type dept">${icons.dept} 부서 답변</span>` : ''}
                  </div>
                </div>
              ` : ''}
            </div>
          </div>
        </div>
      `;
    }

    // 메인 렌더링
    function render() {
      const app = document.getElementById('app');
      const stats = state.isDataLoaded ? getStats() : null;
      
      app.innerHTML = `
        <!-- 헤더 -->
        <header class="border-b border-white/5 glass">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 py-8">
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
              <div>
                <div class="flex items-center gap-4 mb-3">
                  <div class="w-12 h-12 rounded-2xl gold-gradient flex items-center justify-center gold-glow">
                    ${icons.sparkles}
                  </div>
                  <div>
                    <h2 class="text-xl md:text-2xl font-bold gold-text tracking-wide">
                      ${state.schoolInfo.schoolName || '학교명 미설정'}
                    </h2>
                    <p class="text-amber-400/60 text-xs font-medium tracking-widest uppercase mt-1">Education Dashboard</p>
                  </div>
                </div>
                <h1 class="text-xl md:text-3xl font-bold">
                  <span class="gold-text font-display">${state.schoolInfo.year}</span>
                  <span class="text-white ml-2">교육사업평가분석토론회</span>
                </h1>
                <p class="text-slate-500 mt-2">안건 수합 현황 대시보드</p>
              </div>
              ${state.isDataLoaded ? `
                <div class="glass-card rounded-2xl px-6 py-4">
                  <div class="text-4xl font-bold gold-text font-display">${state.agendaData.length}</div>
                  <div class="text-xs text-slate-400 mt-1">총 안건</div>
                </div>
              ` : ''}
            </div>
          </div>
        </header>

        <!-- 네비게이션 -->
        <nav class="border-b border-white/5 glass sticky top-0 z-40">
          <div class="max-w-7xl mx-auto px-4 sm:px-6">
            <div class="flex gap-1 overflow-x-auto custom-scrollbar">
              ${renderTab('settings', '데이터 설정', icons.settings)}
              ${state.isDataLoaded ? `
                ${renderTab('overview', '개괄', icons.home)}
                ${renderTab('list', '안건 목록', icons.folder)}
                ${renderTab('stats', '통계', icons.chart)}
              ` : ''}
            </div>
          </div>
        </nav>

        <!-- 메인 -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 py-10">
          ${state.activeTab === 'settings' ? renderSettings() : ''}
          ${state.activeTab === 'overview' && state.isDataLoaded ? renderOverview(stats) : ''}
          ${state.activeTab === 'list' && state.isDataLoaded ? renderList() : ''}
          ${state.activeTab === 'stats' && state.isDataLoaded ? renderStats(stats) : ''}
        </main>

        <!-- 모달 -->
        ${renderModal()}
      `;

      bindEvents();
      
      // 차트 렌더링
      if (state.activeTab === 'overview' && state.isDataLoaded) {
        renderCharts();
      }
    }

    // 차트 렌더링 함수
    function renderCharts() {
      const stats = getStats();
      const totalItems = state.agendaData.length;
      
      // 부서별 통계
      const deptEntries = Object.entries(stats.deptStats).sort((a, b) => b[1] - a[1]);
      
      // 부서별 색상 팔레트
      const deptColors = [
        'rgba(251, 191, 36, 0.9)',   // amber
        'rgba(59, 130, 246, 0.9)',   // blue
        'rgba(139, 92, 246, 0.9)',   // violet
        'rgba(236, 72, 153, 0.9)',   // pink
        'rgba(34, 197, 94, 0.9)',    // green
        'rgba(14, 165, 233, 0.9)',   // sky
        'rgba(249, 115, 22, 0.9)',   // orange
        'rgba(168, 85, 247, 0.9)',   // purple
        'rgba(20, 184, 166, 0.9)',   // teal
        'rgba(244, 63, 94, 0.9)',    // rose
        'rgba(132, 204, 22, 0.9)',   // lime
        'rgba(99, 102, 241, 0.9)',   // indigo
        'rgba(100, 116, 139, 0.9)', // slate
      ];

      // 부서별 파이차트
      const deptChartEl = document.getElementById('deptPieChart');
      if (deptChartEl) {
        new Chart(deptChartEl, {
          type: 'doughnut',
          data: {
            labels: deptEntries.map(([dept]) => dept.split('\n')[0]),
            datasets: [{
              data: deptEntries.map(([_, count]) => count),
              backgroundColor: deptColors.slice(0, deptEntries.length),
              borderColor: 'rgba(10, 10, 15, 0.8)',
              borderWidth: 2,
              hoverBorderColor: '#fff',
              hoverBorderWidth: 3,
              hoverOffset: 10
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: true,
            cutout: '55%',
            plugins: {
              legend: {
                position: 'right',
                labels: {
                  color: 'rgba(255, 255, 255, 0.7)',
                  font: { family: "'Noto Sans KR', sans-serif", size: 11 },
                  padding: 12,
                  usePointStyle: true,
                  pointStyle: 'circle'
                }
              },
              tooltip: {
                backgroundColor: 'rgba(15, 23, 42, 0.95)',
                titleColor: '#fbbf24',
                bodyColor: '#fff',
                borderColor: 'rgba(251, 191, 36, 0.3)',
                borderWidth: 1,
                padding: 12,
                cornerRadius: 8,
                titleFont: { family: "'Noto Sans KR', sans-serif", weight: '600' },
                bodyFont: { family: "'Noto Sans KR', sans-serif" },
                callbacks: {
                  label: function(context) {
                    const value = context.raw;
                    const percentage = Math.round((value / totalItems) * 100);
                    return ` ${value}건 (${percentage}%)`;
                  }
                }
              }
            },
            animation: {
              animateRotate: true,
              animateScale: true,
              duration: 1000,
              easing: 'easeOutQuart'
            },
            onClick: (event, elements) => {
              if (elements.length > 0) {
                const index = elements[0].index;
                const dept = deptEntries[index][0];
                filterAndShowList(dept);
              }
            }
          }
        });
      }

      // 답변 현황 파이차트
      const answerChartEl = document.getElementById('answerPieChart');
      if (answerChartEl) {
        new Chart(answerChartEl, {
          type: 'doughnut',
          data: {
            labels: ['답변 완료', '대기 중'],
            datasets: [{
              data: [stats.answeredCount, totalItems - stats.answeredCount],
              backgroundColor: ['rgba(34, 197, 94, 0.9)', 'rgba(251, 191, 36, 0.9)'],
              borderColor: 'rgba(10, 10, 15, 0.8)',
              borderWidth: 2,
              hoverOffset: 8
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '65%',
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: 'rgba(15, 23, 42, 0.95)',
                titleColor: '#fbbf24',
                bodyColor: '#fff',
                borderColor: 'rgba(251, 191, 36, 0.3)',
                borderWidth: 1,
                padding: 12,
                cornerRadius: 8
              }
            },
            animation: {
              animateRotate: true,
              animateScale: true,
              duration: 1200,
              easing: 'easeOutQuart'
            }
          }
        });
      }

      // 희망 답변 방식 파이차트
      const responseChartEl = document.getElementById('responsePieChart');
      if (responseChartEl) {
        const deptOnlyCount = state.agendaData.filter(item => 
          item.희망_부서답변 && !item.희망_전체토론 && !item.희망_전체설문
        ).length;
        
        new Chart(responseChartEl, {
          type: 'doughnut',
          data: {
            labels: ['전체 토론', '전체 설문', '부서 답변'],
            datasets: [{
              data: [stats.discussionCount, stats.surveyCount, deptOnlyCount],
              backgroundColor: [
                'rgba(59, 130, 246, 0.9)',
                'rgba(168, 85, 247, 0.9)',
                'rgba(20, 184, 166, 0.9)'
              ],
              borderColor: 'rgba(10, 10, 15, 0.8)',
              borderWidth: 2,
              hoverOffset: 8
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '65%',
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: 'rgba(15, 23, 42, 0.95)',
                titleColor: '#fbbf24',
                bodyColor: '#fff',
                borderColor: 'rgba(251, 191, 36, 0.3)',
                borderWidth: 1,
                padding: 12,
                cornerRadius: 8
              }
            },
            animation: {
              animateRotate: true,
              animateScale: true,
              duration: 1400,
              easing: 'easeOutQuart'
            }
          }
        });
      }
    }

    // 이벤트 핸들러
    function setTab(tab) {
      state.activeTab = tab;
      state.selectedStatsFilter = null; // 탭 변경 시 통계 필터 초기화
      // 안건 목록 탭이 아닌 다른 탭으로 이동할 때만 제안자 필터 초기화
      if (tab !== 'list') {
        state.selectedProposer = null;
      }
      render();
    }

    function filterAndShowList(dept) {
      state.selectedDept = dept;
      state.activeTab = 'list';
      render();
    }

    function clearFilters() {
      state.searchTerm = '';
      state.selectedDept = '전체';
      state.selectedProposer = null;
      render();
    }

    function toggleStatsFilter(filter) {
      state.selectedStatsFilter = state.selectedStatsFilter === filter ? null : filter;
      render();
    }

    function clearStatsFilter() {
      state.selectedStatsFilter = null;
      render();
    }

    function toggleProposerFilter(name) {
      state.selectedProposer = state.selectedProposer === name ? null : name;
      render();
    }

    function selectProposerByIndex(index) {
      const name = currentProposerList[index];
      if (name) {
        state.selectedProposer = name;
        state.activeTab = 'list';
        render();
      }
    }

    function clearProposerFilter() {
      state.selectedProposer = null;
      render();
    }

    function clearProposerOnly() {
      state.selectedProposer = null;
      render();
    }

    function showDetail(id) {
      state.selectedItem = state.agendaData.find(item => item.연번 === id);
      render();
    }

    function closeModal(event) {
      if (event) event.stopPropagation();
      state.selectedItem = null;
      render();
    }

    function saveSchoolInfo() {
      const yearInput = document.getElementById('yearInput');
      const schoolNameInput = document.getElementById('schoolNameInput');
      state.schoolInfo.year = yearInput.value.trim() || '2025';
      state.schoolInfo.schoolName = schoolNameInput.value.trim();
      saveToStorage();
      render();
      alert('기본 정보가 저장되었습니다.');
    }

    function resetData() {
      if (confirm('정말로 모든 데이터를 초기화하시겠습니까?\n이 작업은 되돌릴 수 없습니다.')) {
        localStorage.removeItem('educationDashboard2025');
        state = {
          activeTab: 'settings',
          selectedCategory: '전체',
          selectedDept: '전체',
          searchTerm: '',
          selectedItem: null,
          schoolInfo: { year: '2025', schoolName: '' },
          agendaData: EMBEDDED_DATA,
          isDataLoaded: true
        };
        render();
        alert('모든 데이터가 초기화되었습니다.');
      }
    }

    async function handleFileUpload(file) {
      if (!file) return;
      
      try {
        const data = await parseExcelFile(file);
        if (data.length === 0) {
          alert('파싱된 데이터가 없습니다. 엑셀 파일 형식을 확인해주세요.');
          return;
        }
        
        state.agendaData = data;
        state.isDataLoaded = true;
        saveToStorage();
        render();
        alert(`${data.length}건의 안건을 성공적으로 불러왔습니다.`);
      } catch (error) {
        console.error(error);
        alert('파일 파싱 중 오류가 발생했습니다: ' + error.message);
      }
    }

    function bindEvents() {
      // 검색
      const searchInput = document.getElementById('searchInput');
      if (searchInput) {
        searchInput.addEventListener('input', (e) => {
          state.searchTerm = e.target.value;
          render();
          setTimeout(() => {
            const newInput = document.getElementById('searchInput');
            if (newInput) {
              newInput.focus();
              newInput.setSelectionRange(state.searchTerm.length, state.searchTerm.length);
            }
          }, 0);
        });
      }

      // 부서 필터
      const deptSelect = document.getElementById('deptSelect');
      if (deptSelect) {
        deptSelect.addEventListener('change', (e) => {
          state.selectedDept = e.target.value;
          render();
        });
      }

      // 파일 업로드
      const dropZone = document.getElementById('dropZone');
      const fileInput = document.getElementById('fileInput');
      
      if (dropZone && fileInput) {
        dropZone.addEventListener('click', () => fileInput.click());
        
        dropZone.addEventListener('dragover', (e) => {
          e.preventDefault();
          dropZone.classList.add('dragover');
        });
        
        dropZone.addEventListener('dragleave', () => {
          dropZone.classList.remove('dragover');
        });
        
        dropZone.addEventListener('drop', (e) => {
          e.preventDefault();
          dropZone.classList.remove('dragover');
          const file = e.dataTransfer.files[0];
          if (file) handleFileUpload(file);
        });
        
        fileInput.addEventListener('change', (e) => {
          const file = e.target.files[0];
          if (file) handleFileUpload(file);
        });
      }

      // ESC 키로 모달 닫기
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && state.selectedItem) {
          closeModal();
        }
      });
    }

    // 전역 함수 노출
    window.setTab = setTab;
    window.filterAndShowList = filterAndShowList;
    window.clearFilters = clearFilters;
    window.toggleStatsFilter = toggleStatsFilter;
    window.clearStatsFilter = clearStatsFilter;
    window.toggleProposerFilter = toggleProposerFilter;
    window.selectProposerByIndex = selectProposerByIndex;
    window.clearProposerFilter = clearProposerFilter;
    window.clearProposerOnly = clearProposerOnly;
    window.showDetail = showDetail;
    window.closeModal = closeModal;
    window.saveSchoolInfo = saveSchoolInfo;
    window.resetData = resetData;

    // 초기화
    loadFromStorage();
    render();
  </script>
</body>
</html>
